#include <graphics.h>
#include <stdlib.h>
#include <stdio.h>
#include <conio.h>
#include<math.h>
#include <time.h>


int a[10];
int g=0;
ai_mid()
{
    if ((((a[1]==1)&&(a[2]==1))||((a[4]==1)&&(a[8]==1))||((a[3]==1)&&(a[6]==1)))&&a[0]==0)
        a[0]=1;
    else if((((a[0]==1)&&(a[2]==1))||((a[4]==1)&&(a[7]==1)))&&a[1]==0)
        a[1]=1;
    else if ((((a[0]==1)&&(a[1]==1))||((a[4]==1)&&(a[6]==1))||((a[5]==1)&&(a[8]==1)))&&a[2]==0)
        a[2]=1;
    else if((((a[4]==1)&&(a[5]==1))||((a[0]==1)&&(a[6]==1)))&&a[3]==0)
        a[3]=1;
    else if ((((a[1]==1)&&(a[7]==1))||((a[3]==1)&&(a[5]==1))||((a[0]==1)&&(a[8]==1))||((a[2]==1)&&(a[6]==1)))&&a[4]==0)
        a[4]=1;
    else if((((a[8]==1)&&(a[2]==1))||((a[4]==1)&&(a[3]==1)))&&a[5]==0)
        a[5]=1;
    else if ((((a[0]==1)&&(a[3]==1))||((a[4]==1)&&(a[2]==1))||((a[7]==1)&&(a[8]==1)))&&a[6]==0)
        a[6]=1;
    else if((((a[1]==1)&&(a[4]==1))||((a[6]==1)&&(a[8]==1)))&&a[7]==0)
        a[7]=1;
    else if ((((a[2]==1)&&(a[5]==1))||((a[6]==1)&&(a[7]==1))||((a[0]==1)&&(a[4]==1)))&&a[8]==0)
        a[8]=1;
    else if ((((a[1]==2)&&(a[2]==2))||((a[4]==2)&&(a[8]==2))||((a[3]==2)&&(a[6]==2)))&&a[0]==0)
        a[0]=1;
    else if((((a[0]==2)&&(a[2]==2))||((a[4]==2)&&(a[7]==2)))&&a[1]==0)
        a[1]=1;
    else if ((((a[0]==2)&&(a[1]==2))||((a[4]==2)&&(a[6]==2))||((a[5]==2)&&(a[8]==2)))&&a[2]==0)
        a[2]=1;
    else if((((a[4]==2)&&(a[5]==2))||((a[0]==2)&&(a[6]==2)))&&a[3]==0)
        a[3]=1;
    else if ((((a[1]==2)&&(a[7]==2))||((a[3]==2)&&(a[5]==2))||((a[0]==2)&&(a[8]==2))||((a[2]==2)&&(a[6]==2)))&&a[4]==0)
        a[4]=1;
    else if((((a[8]==2)&&(a[2]==2))||((a[4]==2)&&(a[3]==2)))&&a[5]==0)
        a[5]=1;
    else if ((((a[0]==2)&&(a[3]==2))||((a[4]==2)&&(a[2]==2))||((a[7]==2)&&(a[8]==2)))&&a[6]==0)
        a[6]=1;
    else if((((a[1]==2)&&(a[4]==2))||((a[6]==2)&&(a[8]==2)))&&a[7]==0)
        a[7]=1;
    else if ((((a[2]==2)&&(a[5]==2))||((a[6]==2)&&(a[7]==2))||((a[0]==2)&&(a[4]==2)))&&a[8]==0)
        a[8]=1;

    else
    {
        int i;
        if(a[4]==0)
            a[4]=1;
        else
        for(i=0; i<=8; i++)
        {
            if(a[i]==0)
            {
                a[i]=1;
                break;
            }

        }
    }

}

refresh()
{
    setcolor(15);
    if(a[0]==1)
    {
        line(150,130,200,180);
        line(200,130,150,180);
    }
    if(a[1]==1)
    {
        line(280,130,330,180);
        line(330,130,280,180);
    }
    if(a[2]==1)
    {
        line(400,130,450,180);
        line(450,130,400,180);
    }
    if(a[3]==1)
    {
        line(150,250,200,300);
        line(200,250,150,300);
    }
    if(a[4]==1)
    {
        line(280,250,330,300);
        line(330,250,280,300);
    }
    if(a[5]==1)
    {
        line(400,250,450,300);
        line(450,250,400,300);
    }
    if(a[6]==1)
    {
        line(150,370,200,420);
        line(200,370,150,420);
    }
    if(a[7]==1)
    {
        line(280,370,330,420);
        line(330,370,280,420);
    }
    if(a[8]==1)
    {
        line(400,370,450,420);
        line(450,370,400,420);
    }





    if(a[0]==2)
    {
        circle(175,145,30);
    }
    if(a[1]==2)
    {
        circle(305,145,30);
    }
    if(a[2]==2)
    {
        circle(425,145,30);
    }
    if(a[3]==2)
    {
        circle(175,275,30);
    }
    if(a[4]==2)
    {
        circle(305,275,30);
    }
    if(a[5]==2)
    {
        circle(425,275,30);
    }
    if(a[6]==2)
    {
        circle(175,395,30);
    }
    if(a[7]==2)
    {
        circle(305,395,30);
    }
    if(a[8]==2)
    {
        circle(425,395,30);
    }

}

check()
{
    setcolor(10);
    if((a[0]==1)&&(a[1]==1)&&(a[2]==1))
    {

        line(100,155,500,155);
        g=1;
    }
    if((a[3]==1)&&(a[4]==1)&&(a[5]==1))
    {

        line(100,275,500,275);
        g=1;
    }
    if((a[6]==1)&&(a[7]==1)&&(a[8]==1))
    {

        line(100,395,500,395);
        g=1;
    }
    if((a[0]==1)&&(a[3]==1)&&(a[6]==1))
    {

        line(175,100,175,450);
        g=1;
    }
    if((a[1]==1)&&(a[4]==1)&&(a[7]==1))
    {

        line(305,100,305,450);
        g=1;
    }
    if((a[2]==1)&&(a[5]==1)&&(a[8]==1))
    {

        line(425,100,425,450);
        g=1;
    }
    if((a[0]==1)&&(a[4]==1)&&(a[8]==1))
    {

        line(150,130,450,420);
        g=1;
    }
    if((a[2]==1)&&(a[4]==1)&&(a[6]==1))
    {

        line(450,130,150,420);
        g=1;
    }



    if((a[0]==2)&&(a[1]==2)&&(a[2]==2))
    {

        line(100,155,500,155);
        g=2;
    }
    if((a[3]==2)&&(a[4]==2)&&(a[5]==2))
    {

        line(100,275,500,275);
        g=2;
    }
    if((a[6]==2)&&(a[7]==2)&&(a[8]==2))
    {

        line(100,395,500,395);
        g=2;
    }
    if((a[0]==2)&&(a[3]==2)&&(a[6]==2))
    {

        line(175,100,175,450);
        g=2;
    }
    if((a[1]==2)&&(a[4]==2)&&(a[7]==2))
    {

        line(305,100,305,450);
        g=2;
    }
    if((a[2]==2)&&(a[5]==2)&&(a[8]==2))
    {

        line(425,100,425,450);
        g=2;
    }
    if((a[0]==2)&&(a[4]==2)&&(a[8]==2))
    {

        line(150,130,450,420);
        g=2;
    }
    if((a[2]==2)&&(a[4]==2)&&(a[6]==2))
    {

        line(450,130,150,420);
        g=2;
    }
}

check_cmpl()
{
    if(a[0]!=0&&a[1]!=0&&a[2]!=0&&a[3]!=0&&a[4]!=0&&a[5]!=0&&a[6]!=0&&a[7]!=0&&a[8]!=0)
        g=3;
}

int game()
{
    setcolor(4);
    rectangle(100,200,500,210);
    setfillstyle(1,4);
    floodfill(101,201,4);

    rectangle(100,330,500,340);
    setfillstyle(1,4);
    floodfill(101,331,4);


    rectangle(230,100,240,450);
    setfillstyle(1,4);
    floodfill(231,101,4);
    floodfill(231,211,4);
    floodfill(231,341,4);

    rectangle(360,100,370,450);
    setfillstyle(1,4);
    floodfill(361,101,4);
    floodfill(361,211,4);
    floodfill(361,341,4);




    int cx,cy;
    while (1)
    {
        while (1)
        {
            getmouseclick(WM_LBUTTONDOWN, cx, cy);
            if(cx>100&&cx<230&&cy>100&&cy<200&&a[0]==0)
            {
                a[0]=2;
                refresh();
                break;
            }
            if(cx>240&&cx<360&&cy>100&&cy<200&&a[1]==0)
            {
                a[1]=2;
                refresh();
                break;
            }
            if(cx>370&&cx<500&&cy>100&&cy<200&&a[2]==0)
            {
                a[2]=2;
                refresh();
                break;
            }

            if(cx>100&&cx<230&&cy>210&&cy<330&&a[3]==0)
            {
                a[3]=2;
                refresh();
                break;
            }
            if(cx>240&&cx<360&&cy>210&&cy<330&&a[4]==0)
            {
                a[4]=2;
                refresh();
                break;
            }
            if(cx>370&&cx<500&&cy>210&&cy<330&&a[5]==0)
            {
                a[5]=2;
                refresh();
                break;
            }

            if(cx>100&&cx<230&&cy>340&&cy<450&&a[6]==0)
            {
                a[6]=2;
                refresh();
                break;
            }
            if(cx>240&&cx<360&&cy>340&&cy<450&&a[7]==0)
            {
                a[7]=2;
                refresh();
                break;
            }
            if(cx>370&&cx<500&&cy>340&&cy<450&&a[8]==0)
            {
                a[8]=2;
                refresh();
                break;
            }

        }
        check();
        check_cmpl();
        if(g!=0)
        {
            delay(2000);
            g=0;
            return 0;
        }
        ai_mid();
        refresh();
        check();
        check_cmpl();
        if(g!=0)
        {
            delay(2000);
            g=0;
            return 0;
        }
    }

}

int main(void)
{
    int gdriver = DETECT, gmode, errorcode;

    initwindow(600, 600,"KATAGOLLA AI 0.01 by Tanvir");
    while(1)
    {
        game();
        a[0]=a[1]=a[2]=a[3]=a[4]=a[5]=a[6]=a[7]=a[8]=0;
        clearviewport();
    }
    closegraph();

    return 0;

}
